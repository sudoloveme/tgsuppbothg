## Telegram Support Bot

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –±–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏: –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–µ—Ä–µ—Å—ã–ª–∞—é—Ç—Å—è –≤–ª–∞–¥–µ–ª—å—Ü—É (–≤–∞—à–µ–º—É –∞–∫–∫–∞—É–Ω—Ç—É). –û—Ç–≤–µ—á–∞–π—Ç–µ –≤–ª–∞–¥–µ–ª—å—Ü—É —Ä–µ–ø–ª–∞–µ–º ‚Äî –æ—Ç–≤–µ—Ç —É–π–¥—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

### 1) –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\\Scripts\\activate
pip install -r requirements.txt
```

### 2) –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏:

```
TELEGRAM_BOT_TOKEN=123456:ABC-Your-Bot-Token
# –í–∞—à –ª–∏—á–Ω—ã–π Telegram user ID (chat id). –£–∑–Ω–∞—Ç—å: –æ—Ç–ø—Ä–∞–≤—å—Ç–µ /id –≤ –õ–° –±–æ—Ç—É
OWNER_ID=123456789
## (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –†–µ–∂–∏–º —Ñ–æ—Ä—É–º–∞: ID —Å—É–ø–µ—Ä–≥—Ä—É–ø–ø—ã —Å –≤–∫–ª—é—á—ë–Ω–Ω—ã–º–∏ —Ç–µ–º–∞–º–∏
# –ü—Ä–∏–º–µ—Ä: -1001234567890
SUPPORT_CHAT_ID=-1001234567890
## (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ü—É—Ç—å –∫ SQLite –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é data.db –≤ –∫–æ—Ä–Ω–µ)
DB_PATH=/opt/tg-support-bot/data.db
## (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ID —Ç–µ–º—ã –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–± –æ—Ü–µ–Ω–∫–∞—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1 = General —Ç–µ–º–∞)
RATINGS_NOTIFICATIONS_THREAD_ID=1
## (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) URL –±—ç–∫–µ–Ω–¥ API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å–∏—Å—Ç–µ–º–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
BACKEND_API_URL=https://api.example.com
## (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) API –∫–ª—é—á –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –±—ç–∫–µ–Ω–¥ API
BACKEND_API_KEY=your_api_key_here
## (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) URL –¥–ª—è mini-app (–Ω–∞–ø—Ä–∏–º–µ—Ä, https://your-domain.com –∏–ª–∏ http://your-server-ip:8080)
MINIAPP_URL=https://your-domain.com
## (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ü–æ—Ä—Ç –¥–ª—è mini-app —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 8080)
MINIAPP_PORT=8080
```

–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å OWNER_ID:
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ (—Å–º. –Ω–∏–∂–µ) –∏ –≤ –õ–° –±–æ—Ç—É –æ—Ç–ø—Ä–∞–≤—å—Ç–µ `/id` ‚Äî –±–æ—Ç –æ—Ç–≤–µ—Ç–∏—Ç —á–∏—Å–ª–æ–º. –≠—Ç–æ –∏ –µ—Å—Ç—å –≤–∞—à chat_id.

### 3) –ó–∞–ø—É—Å–∫

```bash
python bot.py
```

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç long polling. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: Ctrl+C.

### 4) –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

- –í–∞—Ä–∏–∞–Ω—Ç –ê (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, `OWNER_ID`): –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç –±–æ—Ç—É ‚Äî –±–æ—Ç –∫–æ–ø–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤–∞–º (–≤–ª–∞–¥–µ–ª—å—Ü—É). –û—Ç–≤–µ—Ç—å—Ç–µ —Ä–µ–ø–ª–∞–µ–º ‚Äî –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
- –í–∞—Ä–∏–∞–Ω—Ç –ë (—Ñ–æ—Ä—É–º, `SUPPORT_CHAT_ID`): –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ–∑–¥–∞—ë—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–µ–º–∞ (topic) –≤ —Å—É–ø–µ—Ä–≥—Ä—É–ø–ø–µ. –°–æ–æ–±—â–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞ –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –≤ –µ–≥–æ —Ç–µ–º—É; –æ—Ç–≤–µ—á–∞–π—Ç–µ —Ä–µ–ø–ª–∞–µ–º –≤ –Ω—É–∂–Ω–æ–π —Ç–µ–º–µ ‚Äî –±–æ—Ç –¥–æ—Å—Ç–∞–≤–∏—Ç –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å:
- –ú–∞–ø–ø–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí topic —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ SQLite (`DB_PATH`), –ø–µ—Ä–µ–∂–∏–≤–∞–µ—Ç —Ä–µ—Å—Ç–∞—Ä—Ç/–¥–µ–ø–ª–æ–π.

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ç–µ–∫—Å—Ç –∏ –º–µ–¥–∏–∞ (–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è), —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è.

### 5) –ö–æ–º–∞–Ω–¥—ã

- `/start` ‚Äî –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è; –ø–æ–¥—Å–∫–∞–∑–∫–∞ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏–≤—è–∑–∞–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫—É –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è mini-app.
- `/id` ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–π chat_id (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å OWNER_ID).
- `/subscription` ‚Äî –æ—Ç–∫—Ä—ã—Ç—å mini-app —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ–¥–ø–∏—Å–∫–µ (–¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π).
- `/stats` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ü–µ–Ω–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (–¥–æ—Å—Ç—É–ø–Ω–∞ –≤–ª–∞–¥–µ–ª—å—Ü—É –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º –≥—Ä—É–ø–ø—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏).
- `/diag` ‚Äî –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö.
- `/linkmail <email>` ‚Äî –ø—Ä–∏–≤—è–∑–∞—Ç—å email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ –µ–≥–æ Telegram ID (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤, —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ç–µ–º–µ —Ñ–æ—Ä—É–º–∞).
- `/info [uuid]` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –ø–æ UUID (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤, —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ç–µ–º–µ —Ñ–æ—Ä—É–º–∞). –ï—Å–ª–∏ UUID –Ω–µ —É–∫–∞–∑–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è UUID –∏–∑ –ë–î –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–µ–º—ã.

### –û—Ü–µ–Ω–∫–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏

–ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Ç–µ–º—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–æ—Å—å–±–æ–π –æ—Ü–µ–Ω–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (–∫–Ω–æ–ø–∫–∏ 1-5). 
–û—Ü–µ–Ω–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É `/stats`.

**–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞–º**: –ü—Ä–∏ –∫–∞–∂–¥–æ–π –æ—Ü–µ–Ω–∫–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –ø–æ–ª—É—á–∞—é—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é —Ç–µ–º—É —Ñ–æ—Ä—É–º–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é General —Ç–µ–º–∞ —Å ID=1). 
–ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –¥—Ä—É–≥—É—é —Ç–µ–º—É —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `RATINGS_NOTIFICATIONS_THREAD_ID`.

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±—ç–∫–µ–Ω–¥ API

–ö–æ–º–∞–Ω–¥–∞ `/linkmail` –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º –ø—Ä–∏–≤—è–∑—ã–≤–∞—Ç—å email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫ –∏—Ö Telegram ID —á–µ—Ä–µ–∑ –±—ç–∫–µ–Ω–¥ API.

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç –≤ —Ç–µ–º—É —Ñ–æ—Ä—É–º–∞ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Å–≤–æ–µ–≥–æ email
2. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤—Ö–æ–¥–∏—Ç –≤ —Ç–µ–º—É –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç: `/linkmail user@example.com`
3. –ë–æ—Ç –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ email —á–µ—Ä–µ–∑ API
4. –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç Telegram ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ –µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç—É
5. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (–≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –º–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è)

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `BACKEND_API_URL` –≤ `.env` —Ñ–∞–π–ª–µ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `BACKEND_API_KEY` –≤ `.env` —Ñ–∞–π–ª–µ (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è)
- –ö–æ–º–∞–Ω–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ —Ñ–æ—Ä—É–º–∞
- –¢—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –ö–æ–º–∞–Ω–¥–∞ –¥–æ–ª–∂–Ω–∞ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –≤–Ω—É—Ç—Ä–∏ —Ç–µ–º—ã, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –ø–∏—Å–∞–ª

### Mini-App –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–¥–ø–∏—Å–∫–µ

–ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Telegram Mini-App, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏—Ö –ø–æ–¥–ø–∏—Å–∫–µ –≤ –∫—Ä–∞—Å–∏–≤–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ.

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏ (–∞–∫—Ç–∏–≤–Ω–∞/–∏—Å—Ç–µ–∫–ª–∞/–Ω–µ–∞–∫—Ç–∏–≤–Ω–∞)
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∞—Ç–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞ (—Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º)
- Email –∏ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- UUID –∏ Short UUID
- Subscription URL (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ MINIAPP_URL –≤ `.env`:**
   ```
   MINIAPP_URL=https://your-domain.com
   # –∏–ª–∏ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
   # MINIAPP_URL=http://your-server-ip:8080
   MINIAPP_PORT=8080
   ```

2. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç –æ—Ç–∫—Ä—ã—Ç –≤ firewall:**
   ```bash
   sudo ufw allow 8080/tcp
   ```

3. **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ nginx —Å HTTPS (–ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤ `nginx_setup.md`):**

   **–ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:**
   ```bash
   # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ nginx –∏ certbot
   sudo apt update
   sudo apt install -y nginx certbot python3-certbot-nginx
   
   # –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–∑–∞–º–µ–Ω–∏—Ç–µ your-domain.com)
   sudo nano /etc/nginx/sites-available/miniapp
   ```
   
   **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è nginx:**
   ```nginx
   server {
       listen 80;
       server_name your-domain.com;
       return 301 https://$server_name$request_uri;
   }
   
   server {
       listen 443 ssl http2;
       server_name your-domain.com;
       
       ssl_certificate /etc/letsencrypt/live/your-domain.com/fullchain.pem;
       ssl_certificate_key /etc/letsencrypt/live/your-domain.com/privkey.pem;
       
       location / {
           proxy_pass http://127.0.0.1:8080;
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_set_header X-Forwarded-Proto $scheme;
       }
   }
   ```
   
   ```bash
   # –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ SSL
   sudo ln -s /etc/nginx/sites-available/miniapp /etc/nginx/sites-enabled/
   sudo nginx -t
   sudo certbot --nginx -d your-domain.com
   
   # –û–±–Ω–æ–≤–∏—Ç—å .env: MINIAPP_URL=https://your-domain.com
   ```
   
   üìñ **–ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏ troubleshooting:** —Å–º. —Ñ–∞–π–ª `nginx_setup.md`

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–∏–≤—è–∑–∞–Ω —á–µ—Ä–µ–∑ `/linkmail` (–∞–¥–º–∏–Ω –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–º–∞–Ω–¥—É)
2. –ü–æ—Å–ª–µ –ø—Ä–∏–≤—è–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç:
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É `/subscription` –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è mini-app
   - –ò–ª–∏ –Ω–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "üìä –ú–æ—è –ø–æ–¥–ø–∏—Å–∫–∞" –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ `/start` (–µ—Å–ª–∏ –ø—Ä–∏–≤—è–∑–∞–Ω)

#### API Endpoint

Mini-app –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π API endpoint:
- `GET /api/subscription/{uuid}` - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ UUID

–î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–∞—é—Ç—Å—è –∏–∑ –±—ç–∫–µ–Ω–¥ API —á–µ—Ä–µ–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `api_client.py`.

### 6) –î–µ–ø–ª–æ–π –Ω–∞ Ubuntu —Å–µ—Ä–≤–µ—Ä

#### –ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π)

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É:
```bash
ssh ubuntu@IP_–°–ï–†–í–ï–†–ê
```

2. –°–∫–∞—á–∞–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è:
```bash
curl -O https://raw.githubusercontent.com/sudoloveme/tgsuppbothg/main/deploy.sh
chmod +x deploy.sh
sudo ./deploy.sh
```

3. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ `/opt/tg-support-bot/`:
```bash
sudo nano /opt/tg-support-bot/.env
```
–î–æ–±–∞–≤—å—Ç–µ:
```
TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω
OWNER_ID=–≤–∞—à_chat_id
# –∏–ª–∏ –¥–ª—è —Ñ–æ—Ä—É–º–∞:
# SUPPORT_CHAT_ID=-1001234567890
```

4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å:
```bash
sudo systemctl restart tg-support-bot
```

#### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
sudo mkdir -p /opt/tg-support-bot
cd /opt/tg-support-bot
sudo git clone https://github.com/sudoloveme/tgsuppbothg.git .

# –°–æ–∑–¥–∞—Ç—å venv –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
sudo python3 -m venv .venv
sudo .venv/bin/pip install -r requirements.txt

# –°–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª
sudo nano .env

# –°–æ–∑–¥–∞—Ç—å systemd service (—Å–º. –ø—Ä–∏–º–µ—Ä –≤ deploy.sh)

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
sudo systemctl enable tg-support-bot
sudo systemctl start tg-support-bot
```

#### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
sudo journalctl -u tg-support-bot -f

# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞
sudo systemctl status tg-support-bot

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞
cd /opt/tg-support-bot
sudo git pull
sudo systemctl restart tg-support-bot

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞/–∑–∞–ø—É—Å–∫
sudo systemctl stop tg-support-bot
sudo systemctl start tg-support-bot
```

### 7) –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ –∏ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ.
- –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ë–î –∏–ª–∏ Webhook, –Ω–æ –¥–ª—è –Ω–∞—á–∞–ª–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ polling.
- –ß—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å —Ñ–æ—Ä—É–º –≤ –≥—Ä—É–ø–ø–µ: –ü—Ä–µ–≤—Ä–∞—Ç–∏—Ç–µ –≥—Ä—É–ø–ø—É –≤ —Å—É–ø–µ—Ä–≥—Ä—É–ø–ø—É –∏ –≤–∫–ª—é—á–∏—Ç–µ "–¢–µ–º—ã" –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö. –ó–∞—Ç–µ–º –¥–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ —Å –ø—Ä–∞–≤–æ–º —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç–µ–º—ã.


